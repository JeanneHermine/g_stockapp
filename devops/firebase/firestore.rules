// Firestore security rules
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    function isSignedIn() { return request.auth != null; }
    function role() { return request.auth.token.role; }
    function isAdmin() { return role() == 'admin'; }
    function isManager() { return role() == 'manager'; }
    function isCashier() { return role() == 'cashier'; }
    function isViewer() { return role() == 'viewer'; }

    match /products/{id} {
      allow read: if isSignedIn();
      allow create, update: if isSignedIn() && (isAdmin() || isManager());
      allow delete: if isSignedIn() && isAdmin();
    }
  }
}
